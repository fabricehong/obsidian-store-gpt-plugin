/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// src/main.ts
var main_exports = {};
__export(main_exports, {
  default: () => StoreGPTPlugin
});
module.exports = __toCommonJS(main_exports);
var import_obsidian5 = require("obsidian");

// src/sgBlock.ts
var import_obsidian4 = require("obsidian");

// src/prompt-resolver.ts
var import_obsidian = require("obsidian");

// src/markdown-leveler.ts
function relevelMarkdownHeaders(markdown, targetBaseLevel) {
  const lines = markdown.split("\n");
  let adjustedMarkdown = "";
  let minCurrentLevel = Infinity;
  lines.forEach((line) => {
    const match = line.match(/^(#+)/);
    if (match) {
      const level = match[0].length;
      if (level < minCurrentLevel) {
        minCurrentLevel = level;
      }
    }
  });
  const levelOffset = targetBaseLevel - minCurrentLevel;
  lines.forEach((line) => {
    const match = line.match(/^(#+)(\s+.*)/);
    if (match) {
      let newLevel = match[1].length + levelOffset;
      if (newLevel < 1)
        newLevel = 1;
      if (newLevel > 6) {
        const boldText = `**${newLevel - 6}. ${match[2].trim()}**`;
        adjustedMarkdown += boldText + "\n";
      } else {
        const newHeader = `${"#".repeat(newLevel)}${match[2]}`;
        adjustedMarkdown += newHeader + "\n";
      }
    } else {
      adjustedMarkdown += line + "\n";
    }
  });
  return adjustedMarkdown.trim();
}
function computePlaceHoldersMarkdownLevel(markdown) {
  const lines = markdown.split("\n");
  let currentLevel = 0;
  let result = {};
  lines.forEach((line) => {
    const headerMatch = line.match(/^(#+)/);
    if (headerMatch) {
      currentLevel = headerMatch[0].length;
    }
    const placeholderMatches = [...line.matchAll(new RegExp(PLACEHOLDER_REGEX, "g"))];
    placeholderMatches.forEach((match) => {
      const placeholderName = match[1];
      if (placeholderName && !(placeholderName in result)) {
        result[placeholderName] = currentLevel;
      }
    });
    if (!headerMatch && !line.trim().startsWith("{{")) {
      currentLevel = 0;
    }
  });
  return result;
}

// src/prompt.ts
var PLACEHOLDER_REGEX = "\\{\\{([\\w-]+)\\}\\}";
var Prompt = class {
  constructor(template, filepath, section = void 0) {
    this.template = template;
    this.filepath = filepath;
    this.section = section;
  }
  remplacePlaceholders(variables) {
    const placeholdersLevels = computePlaceHoldersMarkdownLevel(this.template);
    return this.template.replace(new RegExp(PLACEHOLDER_REGEX, "g"), (match, variableName) => {
      if (!variables.hasOwnProperty(variableName)) {
        throw new Error(`Variable '${variableName}' not found`);
      }
      const placeholderLevel = placeholdersLevels[variableName];
      const markdown = variables[variableName];
      return relevelMarkdownHeaders(markdown, placeholderLevel + 1);
    });
  }
  isEqual(other) {
    return this.filepath === other.filepath && this.section === other.section;
  }
  getPromptId() {
    return !!this.section ? `${this.filepath}#${this.section}` : this.filepath;
  }
};

// src/sg-block-utils.ts
function getCodeBloc(content) {
  const regex = /^\s*```(\w*)\n([\s\S]*?)\n```\s*$/;
  const correspondance = content.match(regex);
  if (correspondance) {
    return {
      content: correspondance[2].trim(),
      blocType: correspondance[1] === "" ? void 0 : correspondance[1]
    };
  }
  return void 0;
}
function removeFrontmatter(content) {
  const regex = /^---[\s\S]+?---\n?/;
  return content.replace(regex, "");
}

// src/prompt-resolver.ts
var PromptResolver = class {
  constructor(app, promptHistory = []) {
    this.app = app;
    this.promptHistory = promptHistory;
  }
  async resolvePrompt(prompt, sourceFile) {
    const newPromptHistory = this.promptHistory.concat(prompt);
    if (this.promptHistory.some((p) => p.isEqual(prompt))) {
      const chainDescription = newPromptHistory.map((p) => {
        if (p.isEqual(prompt)) {
          return `*${p.getPromptId()}*`;
        }
        return p.getPromptId();
      }).join(" -> ");
      throw new Error(`Circular reference detected: ${chainDescription}`);
    }
    const file = this.app.vault.getAbstractFileByPath(sourceFile);
    const variables = {};
    if (!(file instanceof import_obsidian.TFile)) {
      throw new Error("no instance of TFile");
    }
    const fileCache = this.app.metadataCache.getFileCache(file);
    if (!fileCache) {
      throw new Error("Aucun cache de fichier trouv\xE9.");
    }
    const frontmatter = fileCache.frontmatter || {};
    for (const key in frontmatter) {
      const linktext = frontmatter[key];
      const linkTargetContent = await this.determineVariableValue(linktext, file.path);
      if (!linkTargetContent) {
        variables[key] = linktext;
      } else {
        const withoutFrontmatter = removeFrontmatter(linkTargetContent.content);
        const codeBlock = getCodeBloc(withoutFrontmatter);
        if (codeBlock) {
          if (codeBlock.blocType === BLOCK_NAME) {
            const newPrompt = new Prompt(
              codeBlock.content,
              linkTargetContent.filepath,
              linkTargetContent.section
            );
            const promptResolver = new PromptResolver(this.app, newPromptHistory);
            variables[key] = await promptResolver.resolvePrompt(newPrompt, linkTargetContent.filepath);
          } else {
            variables[key] = codeBlock.content;
          }
        } else {
          variables[key] = withoutFrontmatter;
        }
      }
    }
    return prompt.remplacePlaceholders(variables);
  }
  async determineVariableValue(linktext, mainfilePath) {
    const parsed = this.parseLinktext(linktext);
    if (!parsed) {
      return void 0;
    }
    const { path, subpath } = parsed;
    const destFile = this.app.metadataCache.getFirstLinkpathDest(path, mainfilePath);
    if (!destFile) {
      throw new Error(`File '${path}' not found`);
    }
    const linkedFile = this.app.vault.getAbstractFileByPath(destFile.path);
    if (!(linkedFile instanceof import_obsidian.TFile)) {
      throw new Error("no instance of TFile");
    }
    let content = await this.app.vault.read(linkedFile);
    let result;
    if (subpath) {
      result = this.extractSectionContent(content, subpath);
    } else {
      result = content;
    }
    return {
      content: result,
      filepath: destFile.path,
      section: subpath
    };
  }
  parseLinktext(linktext) {
    const match = linktext.match(/\[\[([^\]]+?)(#([^#]+?))?\]\]/);
    if (match) {
      const linkAndLabel = match[1].split("|");
      return { path: linkAndLabel[0], subpath: match[3] };
    }
    return void 0;
  }
  extractSectionContent(content, subpath) {
    const lines = content.split("\n");
    let sectionContent = "";
    let inSection = false;
    let currentLevel = 0;
    for (const line of lines) {
      const headerMatch = line.match(/^(#+)\s+(.*)/);
      if (headerMatch) {
        const level = headerMatch[1].length;
        const title = headerMatch[2].trim();
        if (inSection && level <= currentLevel) {
          break;
        }
        if (title === subpath) {
          inSection = true;
          currentLevel = level;
          continue;
        }
      }
      if (inSection) {
        sectionContent += line + "\n";
      }
    }
    return sectionContent.trim();
  }
};

// src/CopyPromptModal.ts
var import_obsidian2 = require("obsidian");
var CopyPromptModal = class extends import_obsidian2.Modal {
  constructor(app, prompt, onSubmit) {
    super(app);
    this.onSubmit = onSubmit;
    this.prompt = prompt;
  }
  onOpen() {
    const { contentEl } = this;
    contentEl.createEl("h1", { text: "Prompt" });
    const textarea = contentEl.createEl("textarea", {
      attr: {
        style: "width: 100%; box-sizing: border-box; margin-bottom: 20px;"
        // Assure que le textarea prend toute la largeur et ajoute un peu d'espace en dessous
      }
    });
    textarea.value = this.prompt;
    textarea.rows = 10;
    const buttonContainer = contentEl.createEl("div", {
      attr: {
        style: "text-align: right;"
        // Alignement du bouton à droite
      }
    });
    const button = buttonContainer.createEl("button", { text: "Copy" });
    button.addClass("mod-cta");
    button.addEventListener("click", () => {
      this.close();
      this.onSubmit(textarea.value);
    });
  }
  onClose() {
    let { contentEl } = this;
    contentEl.empty();
  }
};

// src/ErrorModal.ts
var import_obsidian3 = require("obsidian");
var ErrorModal = class extends import_obsidian3.Modal {
  constructor(app, message) {
    super(app);
    this.message = message;
  }
  onOpen() {
    const { contentEl } = this;
    const messageEl = contentEl.createEl("p");
    messageEl.setText(this.message);
    const okButton = contentEl.createEl("button", {
      text: "OK",
      cls: "mod-cta"
      // Utilise une classe pour ajouter des styles spécifiques si nécessaire
    });
    okButton.addEventListener("click", () => {
      this.close();
    });
    contentEl.style.display = "flex";
    contentEl.style.flexDirection = "column";
    contentEl.style.alignItems = "center";
    contentEl.style.justifyContent = "center";
  }
  onClose() {
    const { contentEl } = this;
    contentEl.empty();
  }
};

// src/sgBlock.ts
var BLOCK_NAME = "sg";
var SGBlock = class {
  constructor(plugin) {
    this.plugin = plugin;
    this.plugin.registerMarkdownCodeBlockProcessor(
      BLOCK_NAME,
      async (source, el, ctx) => {
        this.blockTgHandler(source, el, ctx);
      }
    );
  }
  async blockTgHandler(source, container, { sourcePath: path }) {
    setTimeout(async () => {
      const preElement = document.createElement("pre");
      preElement.style.whiteSpace = "pre-wrap";
      const codeElement = document.createElement("code");
      codeElement.textContent = source;
      preElement.appendChild(codeElement);
      container.appendChild(preElement);
      this.addTGMenu(container, source, path);
    }, 100);
  }
  addTGMenu(el, source, sourcePath) {
    var _a;
    const div = document.createElement("div");
    div.classList.add("plug-tg-tgmenu", "plug-tg-flex", "plug-tg-justify-end");
    const generateSVG = `<svg viewBox="0 0 100 100" class="svg-icon GENERATE_ICON"><defs><style>.cls-1{fill:none;stroke:currentColor;stroke-linecap:round;stroke-linejoin:round;stroke-width:4px;}</style></defs><g id="Layer_2" data-name="Layer 2"><g id="VECTOR"><rect class="cls-1" x="74.98" y="21.55" width="18.9" height="37.59"></rect><path class="cls-1" d="M38.44,27.66a8,8,0,0,0-8.26,1.89L24.8,34.86a25.44,25.44,0,0,0-6,9.3L14.14,56.83C11.33,64.7,18.53,67.3,21,60.9" transform="translate(-1.93 -15.75)"></path><polyline class="cls-1" points="74.98 25.58 56.61 18.72 46.72 15.45"></polyline><path class="cls-1" d="M55.45,46.06,42.11,49.43,22.76,50.61c-8.27,1.3-5.51,11.67,4.88,12.8L46.5,65.78,53,68.4a23.65,23.65,0,0,0,17.9,0l6-2.46" transform="translate(-1.93 -15.75)"></path><path class="cls-1" d="M37.07,64.58v5.91A3.49,3.49,0,0,1,33.65,74h0a3.49,3.49,0,0,1-3.45-3.52V64.58" transform="translate(-1.93 -15.75)"></path><path class="cls-1" d="M48,66.58v5.68a3.4,3.4,0,0,1-3.34,3.46h0a3.4,3.4,0,0,1-3.34-3.45h0V65.58" transform="translate(-1.93 -15.75)"></path><polyline class="cls-1" points="28.75 48.05 22.66 59.3 13.83 65.61 14.41 54.5 19.11 45.17"></polyline><polyline class="cls-1" points="25.17 34.59 43.75 0.25 52.01 5.04 36.39 33.91"></polyline><line class="cls-1" x1="0.25" y1="66.92" x2="13.83" y2="66.92"></line></g></g></svg>`;
    const button = this.createRunButton("Generate Text", generateSVG);
    button.addEventListener("click", async () => {
      console.log("trigger");
      try {
        const promptResolver = new PromptResolver(this.plugin.app);
        let resolvedPrompt = await promptResolver.resolvePrompt(new Prompt(source, sourcePath), sourcePath);
        new CopyPromptModal(this.plugin.app, resolvedPrompt, (result) => {
          this.copyToClipboard(result);
          new import_obsidian4.Notice("Prompt copied to clipboard", 3e3);
        }).open();
      } catch (e) {
        new ErrorModal(this.plugin.app, e.message).open();
        throw e;
      }
    });
    div.appendChild(button);
    (_a = el.parentElement) == null ? void 0 : _a.appendChild(div);
  }
  async copyToClipboard(texte) {
    try {
      await navigator.clipboard.writeText(texte);
      console.log("Texte copi\xE9 dans le presse-papier");
    } catch (err) {
      console.error("Erreur lors de la copie dans le presse-papier", err);
    }
  }
  createRunButton(label, svg) {
    const button = document.createElement("div");
    button.classList.add("clickable-icon");
    button.setAttribute("aria-label", label);
    button.innerHTML = svg;
    return button;
  }
};

// src/main.ts
var DEFAULT_SETTINGS = {
  mySetting: "default"
};
var StoreGPTPlugin = class extends import_obsidian5.Plugin {
  async onload() {
    await this.loadSettings();
    new SGBlock(this);
  }
  onunload() {
  }
  async loadSettings() {
    this.settings = Object.assign({}, DEFAULT_SETTINGS, await this.loadData());
  }
  async saveSettings() {
    await this.saveData(this.settings);
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsic3JjL21haW4udHMiLCAic3JjL3NnQmxvY2sudHMiLCAic3JjL3Byb21wdC1yZXNvbHZlci50cyIsICJzcmMvbWFya2Rvd24tbGV2ZWxlci50cyIsICJzcmMvcHJvbXB0LnRzIiwgInNyYy9zZy1ibG9jay11dGlscy50cyIsICJzcmMvQ29weVByb21wdE1vZGFsLnRzIiwgInNyYy9FcnJvck1vZGFsLnRzIl0sCiAgInNvdXJjZXNDb250ZW50IjogWyJpbXBvcnQgeyBQbHVnaW4gfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgU0dCbG9jayBmcm9tIFwiLi9zZ0Jsb2NrXCI7XG5cbi8vIFJlbWVtYmVyIHRvIHJlbmFtZSB0aGVzZSBjbGFzc2VzIGFuZCBpbnRlcmZhY2VzIVxuXG5pbnRlcmZhY2UgU3RvcmVHUFRQbHVnaW5TZXR0aW5ncyB7XG5cdG15U2V0dGluZzogc3RyaW5nO1xufVxuXG5jb25zdCBERUZBVUxUX1NFVFRJTkdTOiBTdG9yZUdQVFBsdWdpblNldHRpbmdzID0ge1xuXHRteVNldHRpbmc6ICdkZWZhdWx0J1xufVxuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBTdG9yZUdQVFBsdWdpbiBleHRlbmRzIFBsdWdpbiB7XG5cdHNldHRpbmdzOiBTdG9yZUdQVFBsdWdpblNldHRpbmdzO1xuXG5cdGFzeW5jIG9ubG9hZCgpIHtcblx0XHRhd2FpdCB0aGlzLmxvYWRTZXR0aW5ncygpO1xuXG5cdFx0bmV3IFNHQmxvY2sodGhpcyk7XG5cdH1cblxuXHRvbnVubG9hZCgpIHtcblxuXHR9XG5cblx0YXN5bmMgbG9hZFNldHRpbmdzKCkge1xuXHRcdHRoaXMuc2V0dGluZ3MgPSBPYmplY3QuYXNzaWduKHt9LCBERUZBVUxUX1NFVFRJTkdTLCBhd2FpdCB0aGlzLmxvYWREYXRhKCkpO1xuXHR9XG5cblx0YXN5bmMgc2F2ZVNldHRpbmdzKCkge1xuXHRcdGF3YWl0IHRoaXMuc2F2ZURhdGEodGhpcy5zZXR0aW5ncyk7XG5cdH1cbn1cbiIsICJpbXBvcnQgeyBNYXJrZG93blBvc3RQcm9jZXNzb3JDb250ZXh0LCBOb3RpY2UgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCBTdG9yZUdQVFBsdWdpbiBmcm9tIFwiLi9tYWluXCI7XG5pbXBvcnQgeyBQcm9tcHRSZXNvbHZlciB9IGZyb20gXCIuL3Byb21wdC1yZXNvbHZlclwiO1xuaW1wb3J0IHsgQ29weVByb21wdE1vZGFsIH0gZnJvbSBcIi4vQ29weVByb21wdE1vZGFsXCI7XG5pbXBvcnQgeyBQcm9tcHQgfSBmcm9tIFwiLi9wcm9tcHRcIjtcbmltcG9ydCB7IEVycm9yTW9kYWwgfSBmcm9tIFwiLi9FcnJvck1vZGFsXCI7XG5cbmV4cG9ydCBjb25zdCBCTE9DS19OQU1FID0gJ3NnJztcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFNHQmxvY2sge1xuXHRwbHVnaW46IFN0b3JlR1BUUGx1Z2luO1xuXHRjb25zdHJ1Y3RvcihwbHVnaW46IFN0b3JlR1BUUGx1Z2luKSB7XG5cdFx0dGhpcy5wbHVnaW4gPSBwbHVnaW47XG5cblx0XHR0aGlzLnBsdWdpbi5yZWdpc3Rlck1hcmtkb3duQ29kZUJsb2NrUHJvY2Vzc29yKFxuXHRcdFx0QkxPQ0tfTkFNRSxcblx0XHRcdGFzeW5jIChzb3VyY2UsIGVsLCBjdHgpID0+IHtcblx0XHRcdFx0dGhpcy5ibG9ja1RnSGFuZGxlcihzb3VyY2UsIGVsLCBjdHgpO1xuXHRcdFx0fVxuXHRcdCk7XG5cdH1cblxuXHRhc3luYyBibG9ja1RnSGFuZGxlcihcblx0XHRzb3VyY2U6IHN0cmluZyxcblx0XHRjb250YWluZXI6IEhUTUxFbGVtZW50LFxuXHRcdHsgc291cmNlUGF0aDogcGF0aCB9OiBNYXJrZG93blBvc3RQcm9jZXNzb3JDb250ZXh0XG5cdCkge1xuXHRcdHNldFRpbWVvdXQoYXN5bmMgKCkgPT4ge1xuXHRcdFx0Y29uc3QgcHJlRWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3ByZScpO1xuXHRcdFx0cHJlRWxlbWVudC5zdHlsZS53aGl0ZVNwYWNlID0gJ3ByZS13cmFwJzsgLy8gR2FyZGUgbGVzIHNhdXRzIGRlIGxpZ25lIGV0IGVzcGFjZXNcblxuXHRcdFx0Ly8gQ3JcdTAwRTlhdGlvbiBkJ3VuIFx1MDBFOWxcdTAwRTltZW50IGNvZGUgcXVpIGNvbnRpZW5kcmEgbGUgdGV4dGVcblx0XHRcdGNvbnN0IGNvZGVFbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnY29kZScpO1xuXHRcdFx0Y29kZUVsZW1lbnQudGV4dENvbnRlbnQgPSBzb3VyY2U7IC8vIEFzc2lnbmUgbGUgY29udGVudSBzb3VyY2UgXHUwMEUwIGwnXHUwMEU5bFx1MDBFOW1lbnQgY29kZVxuXG5cdFx0XHQvLyBBam91dGUgbCdcdTAwRTlsXHUwMEU5bWVudCBjb2RlIFx1MDBFMCBsJ1x1MDBFOWxcdTAwRTltZW50IHByZVxuXHRcdFx0cHJlRWxlbWVudC5hcHBlbmRDaGlsZChjb2RlRWxlbWVudCk7XG5cblx0XHRcdC8vIEFqb3V0ZSBsJ1x1MDBFOWxcdTAwRTltZW50IHByZSBhdSBjb250YWluZXIgcG91ciBsJ2FmZmljaGFnZVxuXHRcdFx0Y29udGFpbmVyLmFwcGVuZENoaWxkKHByZUVsZW1lbnQpO1xuXG5cdFx0XHR0aGlzLmFkZFRHTWVudShjb250YWluZXIsIHNvdXJjZSwgcGF0aCk7XG5cdFx0fSwgMTAwKTtcblx0fVxuXG5cdHByaXZhdGUgYWRkVEdNZW51KFxuXHRcdGVsOiBIVE1MRWxlbWVudCxcblx0XHRzb3VyY2U6IHN0cmluZyxcblx0XHRzb3VyY2VQYXRoOiBzdHJpbmdcblx0KSB7XG5cdFx0Y29uc3QgZGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcblx0XHRkaXYuY2xhc3NMaXN0LmFkZChcInBsdWctdGctdGdtZW51XCIsIFwicGx1Zy10Zy1mbGV4XCIsIFwicGx1Zy10Zy1qdXN0aWZ5LWVuZFwiKTtcblx0XHRjb25zdCBnZW5lcmF0ZVNWRyA9IGA8c3ZnIHZpZXdCb3g9XCIwIDAgMTAwIDEwMFwiIGNsYXNzPVwic3ZnLWljb24gR0VORVJBVEVfSUNPTlwiPjxkZWZzPjxzdHlsZT4uY2xzLTF7ZmlsbDpub25lO3N0cm9rZTpjdXJyZW50Q29sb3I7c3Ryb2tlLWxpbmVjYXA6cm91bmQ7c3Ryb2tlLWxpbmVqb2luOnJvdW5kO3N0cm9rZS13aWR0aDo0cHg7fTwvc3R5bGU+PC9kZWZzPjxnIGlkPVwiTGF5ZXJfMlwiIGRhdGEtbmFtZT1cIkxheWVyIDJcIj48ZyBpZD1cIlZFQ1RPUlwiPjxyZWN0IGNsYXNzPVwiY2xzLTFcIiB4PVwiNzQuOThcIiB5PVwiMjEuNTVcIiB3aWR0aD1cIjE4LjlcIiBoZWlnaHQ9XCIzNy41OVwiPjwvcmVjdD48cGF0aCBjbGFzcz1cImNscy0xXCIgZD1cIk0zOC40NCwyNy42NmE4LDgsMCwwLDAtOC4yNiwxLjg5TDI0LjgsMzQuODZhMjUuNDQsMjUuNDQsMCwwLDAtNiw5LjNMMTQuMTQsNTYuODNDMTEuMzMsNjQuNywxOC41Myw2Ny4zLDIxLDYwLjlcIiB0cmFuc2Zvcm09XCJ0cmFuc2xhdGUoLTEuOTMgLTE1Ljc1KVwiPjwvcGF0aD48cG9seWxpbmUgY2xhc3M9XCJjbHMtMVwiIHBvaW50cz1cIjc0Ljk4IDI1LjU4IDU2LjYxIDE4LjcyIDQ2LjcyIDE1LjQ1XCI+PC9wb2x5bGluZT48cGF0aCBjbGFzcz1cImNscy0xXCIgZD1cIk01NS40NSw0Ni4wNiw0Mi4xMSw0OS40MywyMi43Niw1MC42MWMtOC4yNywxLjMtNS41MSwxMS42Nyw0Ljg4LDEyLjhMNDYuNSw2NS43OCw1Myw2OC40YTIzLjY1LDIzLjY1LDAsMCwwLDE3LjksMGw2LTIuNDZcIiB0cmFuc2Zvcm09XCJ0cmFuc2xhdGUoLTEuOTMgLTE1Ljc1KVwiPjwvcGF0aD48cGF0aCBjbGFzcz1cImNscy0xXCIgZD1cIk0zNy4wNyw2NC41OHY1LjkxQTMuNDksMy40OSwwLDAsMSwzMy42NSw3NGgwYTMuNDksMy40OSwwLDAsMS0zLjQ1LTMuNTJWNjQuNThcIiB0cmFuc2Zvcm09XCJ0cmFuc2xhdGUoLTEuOTMgLTE1Ljc1KVwiPjwvcGF0aD48cGF0aCBjbGFzcz1cImNscy0xXCIgZD1cIk00OCw2Ni41OHY1LjY4YTMuNCwzLjQsMCwwLDEtMy4zNCwzLjQ2aDBhMy40LDMuNCwwLDAsMS0zLjM0LTMuNDVoMFY2NS41OFwiIHRyYW5zZm9ybT1cInRyYW5zbGF0ZSgtMS45MyAtMTUuNzUpXCI+PC9wYXRoPjxwb2x5bGluZSBjbGFzcz1cImNscy0xXCIgcG9pbnRzPVwiMjguNzUgNDguMDUgMjIuNjYgNTkuMyAxMy44MyA2NS42MSAxNC40MSA1NC41IDE5LjExIDQ1LjE3XCI+PC9wb2x5bGluZT48cG9seWxpbmUgY2xhc3M9XCJjbHMtMVwiIHBvaW50cz1cIjI1LjE3IDM0LjU5IDQzLjc1IDAuMjUgNTIuMDEgNS4wNCAzNi4zOSAzMy45MVwiPjwvcG9seWxpbmU+PGxpbmUgY2xhc3M9XCJjbHMtMVwiIHgxPVwiMC4yNVwiIHkxPVwiNjYuOTJcIiB4Mj1cIjEzLjgzXCIgeTI9XCI2Ni45MlwiPjwvbGluZT48L2c+PC9nPjwvc3ZnPmA7XG5cblx0XHRjb25zdCBidXR0b24gPSB0aGlzLmNyZWF0ZVJ1bkJ1dHRvbihcIkdlbmVyYXRlIFRleHRcIiwgZ2VuZXJhdGVTVkcpO1xuXHRcdGJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgYXN5bmMgKCkgPT4ge1xuXHRcdFx0Y29uc29sZS5sb2coJ3RyaWdnZXInKTtcblxuXG5cdFx0XHR0cnkge1xuXHRcdFx0XHRjb25zdCBwcm9tcHRSZXNvbHZlciA9IG5ldyBQcm9tcHRSZXNvbHZlcih0aGlzLnBsdWdpbi5hcHApO1xuXHRcdFx0XHRsZXQgcmVzb2x2ZWRQcm9tcHQgPSBhd2FpdCBwcm9tcHRSZXNvbHZlci5yZXNvbHZlUHJvbXB0KG5ldyBQcm9tcHQoc291cmNlLCBzb3VyY2VQYXRoKSwgc291cmNlUGF0aCk7XG5cblx0XHRcdFx0bmV3IENvcHlQcm9tcHRNb2RhbCh0aGlzLnBsdWdpbi5hcHAsIHJlc29sdmVkUHJvbXB0LCAocmVzdWx0OiBzdHJpbmcpID0+IHtcblx0XHRcdFx0XHR0aGlzLmNvcHlUb0NsaXBib2FyZChyZXN1bHQpO1xuXHRcdFx0XHRcdG5ldyBOb3RpY2UoXCJQcm9tcHQgY29waWVkIHRvIGNsaXBib2FyZFwiLCAzMDAwKTtcblx0XHRcdFx0fSkub3BlbigpO1xuXHRcdFx0fSBjYXRjaCAoZSkge1xuXHRcdFx0XHRuZXcgRXJyb3JNb2RhbCh0aGlzLnBsdWdpbi5hcHAsIGUubWVzc2FnZSkub3BlbigpO1xuXHRcdFx0XHR0aHJvdyBlO1xuXHRcdFx0fVxuXHRcdH0pO1xuXG5cdFx0ZGl2LmFwcGVuZENoaWxkKGJ1dHRvbik7XG5cdFx0ZWwucGFyZW50RWxlbWVudD8uYXBwZW5kQ2hpbGQoZGl2KTtcblx0fVxuXG5cdHByaXZhdGUgYXN5bmMgY29weVRvQ2xpcGJvYXJkKHRleHRlOiBzdHJpbmcpIHtcblx0XHR0cnkge1xuXHRcdFx0YXdhaXQgbmF2aWdhdG9yLmNsaXBib2FyZC53cml0ZVRleHQodGV4dGUpO1xuXHRcdFx0Y29uc29sZS5sb2coJ1RleHRlIGNvcGlcdTAwRTkgZGFucyBsZSBwcmVzc2UtcGFwaWVyJyk7XG5cdFx0fSBjYXRjaCAoZXJyKSB7XG5cdFx0XHRjb25zb2xlLmVycm9yKCdFcnJldXIgbG9ycyBkZSBsYSBjb3BpZSBkYW5zIGxlIHByZXNzZS1wYXBpZXInLCBlcnIpO1xuXHRcdH1cblx0fVxuXG5cdGNyZWF0ZVJ1bkJ1dHRvbihsYWJlbDogc3RyaW5nLCBzdmc6IHN0cmluZykge1xuXHRcdGNvbnN0IGJ1dHRvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG5cdFx0YnV0dG9uLmNsYXNzTGlzdC5hZGQoXCJjbGlja2FibGUtaWNvblwiKTtcblx0XHRidXR0b24uc2V0QXR0cmlidXRlKFwiYXJpYS1sYWJlbFwiLCBsYWJlbCk7XG5cdFx0Ly9hcmlhLWxhYmVsLXBvc2l0aW9uPVwicmlnaHRcIlxuXHRcdGJ1dHRvbi5pbm5lckhUTUwgPSBzdmc7XG5cblx0XHRyZXR1cm4gYnV0dG9uO1xuXHR9XG5cbn1cbiIsICJpbXBvcnQgeyBBcHAsIFRGaWxlIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgeyBQcm9tcHQgfSBmcm9tIFwiLi9wcm9tcHRcIjtcbmltcG9ydCB7IGdldENvZGVCbG9jLCByZW1vdmVGcm9udG1hdHRlciB9IGZyb20gXCIuL3NnLWJsb2NrLXV0aWxzXCI7XG5pbXBvcnQgeyBCTE9DS19OQU1FIH0gZnJvbSBcIi4vc2dCbG9ja1wiO1xuXG5leHBvcnQgY2xhc3MgUHJvbXB0UmVzb2x2ZXIge1xuXHRjb25zdHJ1Y3Rvcihwcml2YXRlIHJlYWRvbmx5IGFwcDogQXBwLCBwcml2YXRlIHJlYWRvbmx5IHByb21wdEhpc3Rvcnk6IFByb21wdFtdID0gW10pIHt9XG5cblx0cHVibGljIGFzeW5jIHJlc29sdmVQcm9tcHQocHJvbXB0OiBQcm9tcHQsIHNvdXJjZUZpbGU6IHN0cmluZyk6IFByb21pc2U8c3RyaW5nPiB7XG5cdFx0Y29uc3QgbmV3UHJvbXB0SGlzdG9yeSA9IHRoaXMucHJvbXB0SGlzdG9yeS5jb25jYXQocHJvbXB0KTtcblxuXHRcdGlmICh0aGlzLnByb21wdEhpc3Rvcnkuc29tZSgocCkgPT4gcC5pc0VxdWFsKHByb21wdCkpKSB7XG5cdFx0XHRjb25zdCBjaGFpbkRlc2NyaXB0aW9uID0gbmV3UHJvbXB0SGlzdG9yeS5tYXAoKHApID0+IHtcblx0XHRcdFx0aWYgKHAuaXNFcXVhbChwcm9tcHQpKSB7XG5cdFx0XHRcdFx0cmV0dXJuIGAqJHtwLmdldFByb21wdElkKCl9KmA7XG5cdFx0XHRcdH1cblx0XHRcdFx0cmV0dXJuIHAuZ2V0UHJvbXB0SWQoKTtcblx0XHRcdH0pLmpvaW4oJyAtPiAnKTtcblx0XHRcdHRocm93IG5ldyBFcnJvcihgQ2lyY3VsYXIgcmVmZXJlbmNlIGRldGVjdGVkOiAke2NoYWluRGVzY3JpcHRpb259YCk7XG5cdFx0fVxuXHRcdGNvbnN0IGZpbGUgPSB0aGlzLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgoc291cmNlRmlsZSk7XG5cdFx0Y29uc3QgdmFyaWFibGVzOiB7W2tleTogc3RyaW5nXTogc3RyaW5nfSA9IHt9XG5cblx0XHRpZiAoIShmaWxlIGluc3RhbmNlb2YgVEZpbGUpKSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ25vIGluc3RhbmNlIG9mIFRGaWxlJyk7XG5cdFx0fVxuXHRcdC8vIFJcdTAwRTljdXBcdTAwRThyZSBsZSBjYWNoZSBkdSBmaWNoaWVyIGFjdHVlbCBwb3VyIGFjY1x1MDBFOWRlciBhdSBmcm9udG1hdHRlclxuXHRcdGNvbnN0IGZpbGVDYWNoZSA9IHRoaXMuYXBwLm1ldGFkYXRhQ2FjaGUuZ2V0RmlsZUNhY2hlKGZpbGUpO1xuXHRcdGlmICghZmlsZUNhY2hlKSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoXCJBdWN1biBjYWNoZSBkZSBmaWNoaWVyIHRyb3V2XHUwMEU5LlwiKTtcblx0XHR9XG5cdFx0Y29uc3QgZnJvbnRtYXR0ZXIgPSBmaWxlQ2FjaGUuZnJvbnRtYXR0ZXIgfHwge307XG5cblx0XHRmb3IgKGNvbnN0IGtleSBpbiBmcm9udG1hdHRlcikge1xuXHRcdFx0Y29uc3QgbGlua3RleHQgPSBmcm9udG1hdHRlcltrZXldO1xuXHRcdFx0Y29uc3QgbGlua1RhcmdldENvbnRlbnQgPSBhd2FpdCB0aGlzLmRldGVybWluZVZhcmlhYmxlVmFsdWUobGlua3RleHQsIGZpbGUucGF0aCk7XG5cdFx0XHRpZiAoIWxpbmtUYXJnZXRDb250ZW50KSB7XG5cdFx0XHRcdHZhcmlhYmxlc1trZXldID0gbGlua3RleHQ7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRjb25zdCB3aXRob3V0RnJvbnRtYXR0ZXIgPSByZW1vdmVGcm9udG1hdHRlcihsaW5rVGFyZ2V0Q29udGVudC5jb250ZW50KTtcblx0XHRcdFx0Y29uc3QgY29kZUJsb2NrID0gZ2V0Q29kZUJsb2Mod2l0aG91dEZyb250bWF0dGVyKTtcblx0XHRcdFx0aWYgKGNvZGVCbG9jaykge1xuXHRcdFx0XHRcdGlmIChjb2RlQmxvY2suYmxvY1R5cGUgPT09IEJMT0NLX05BTUUpIHtcblx0XHRcdFx0XHRcdGNvbnN0IG5ld1Byb21wdCA9IG5ldyBQcm9tcHQoXG5cdFx0XHRcdFx0XHRcdGNvZGVCbG9jay5jb250ZW50LFxuXHRcdFx0XHRcdFx0XHRsaW5rVGFyZ2V0Q29udGVudC5maWxlcGF0aCxcblx0XHRcdFx0XHRcdFx0bGlua1RhcmdldENvbnRlbnQuc2VjdGlvblxuXHRcdFx0XHRcdFx0KTtcblx0XHRcdFx0XHRcdGNvbnN0IHByb21wdFJlc29sdmVyID0gbmV3IFByb21wdFJlc29sdmVyKHRoaXMuYXBwLCBuZXdQcm9tcHRIaXN0b3J5KTtcblx0XHRcdFx0XHRcdHZhcmlhYmxlc1trZXldID0gYXdhaXQgcHJvbXB0UmVzb2x2ZXIucmVzb2x2ZVByb21wdChuZXdQcm9tcHQsIGxpbmtUYXJnZXRDb250ZW50LmZpbGVwYXRoKTtcblx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0dmFyaWFibGVzW2tleV0gPSBjb2RlQmxvY2suY29udGVudDtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0dmFyaWFibGVzW2tleV0gPSB3aXRob3V0RnJvbnRtYXR0ZXI7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cblx0XHRyZXR1cm4gcHJvbXB0LnJlbXBsYWNlUGxhY2Vob2xkZXJzKHZhcmlhYmxlcylcblx0fVxuXG5cblx0cHJpdmF0ZSBhc3luYyBkZXRlcm1pbmVWYXJpYWJsZVZhbHVlKGxpbmt0ZXh0OiBhbnksIG1haW5maWxlUGF0aDogc3RyaW5nKTogUHJvbWlzZTx7Y29udGVudDogc3RyaW5nLCBmaWxlcGF0aDogc3RyaW5nLCBzZWN0aW9uOiBzdHJpbmcgfCB1bmRlZmluZWR9IHwgdW5kZWZpbmVkPiB7XG5cdFx0Ly8gVXRpbGlzZSBwYXJzZUxpbmt0ZXh0IHBvdXIgZXh0cmFpcmUgY2hlbWluIGV0IHNvdXMtY2hlbWluXG5cdFx0Y29uc3QgcGFyc2VkID0gdGhpcy5wYXJzZUxpbmt0ZXh0KGxpbmt0ZXh0KTtcblx0XHRpZiAoIXBhcnNlZCkge1xuXHRcdFx0cmV0dXJuIHVuZGVmaW5lZDtcblx0XHR9XG5cdFx0Y29uc3QgeyBwYXRoLCBzdWJwYXRoIH0gPSBwYXJzZWQ7XG5cblx0XHQvLyBSXHUwMEU5c291ZHJlIGxlIGNoZW1pbiBkdSBsaWVuXG5cdFx0Y29uc3QgZGVzdEZpbGUgPSB0aGlzLmFwcC5tZXRhZGF0YUNhY2hlLmdldEZpcnN0TGlua3BhdGhEZXN0KHBhdGgsIG1haW5maWxlUGF0aCk7XG5cblx0XHRpZiAoIWRlc3RGaWxlKSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoYEZpbGUgJyR7cGF0aH0nIG5vdCBmb3VuZGApO1xuXHRcdH1cblx0XHRjb25zdCBsaW5rZWRGaWxlID0gdGhpcy5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKGRlc3RGaWxlLnBhdGgpO1xuXHRcdGlmICghKGxpbmtlZEZpbGUgaW5zdGFuY2VvZiBURmlsZSkpIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcignbm8gaW5zdGFuY2Ugb2YgVEZpbGUnKTtcblx0XHR9XG5cdFx0Ly8gTGlyZSBsZSBjb250ZW51IGR1IGZpY2hpZXIgbGlcdTAwRTlcblx0XHRsZXQgY29udGVudCA9IGF3YWl0IHRoaXMuYXBwLnZhdWx0LnJlYWQobGlua2VkRmlsZSk7XG5cblx0XHQvLyBTaSB1biBzb3VzLWNoZW1pbiBlc3Qgc3BcdTAwRTljaWZpXHUwMEU5LCBleHRyYWlyZSBsYSBzZWN0aW9uIHNwXHUwMEU5Y2lmaXF1ZSBkdSBjb250ZW51XG5cdFx0bGV0IHJlc3VsdDtcblx0XHRpZiAoc3VicGF0aCkge1xuXHRcdFx0cmVzdWx0ID0gdGhpcy5leHRyYWN0U2VjdGlvbkNvbnRlbnQoY29udGVudCwgc3VicGF0aCk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHJlc3VsdCA9IGNvbnRlbnQ7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIHtcblx0XHRcdGNvbnRlbnQ6IHJlc3VsdCxcblx0XHRcdGZpbGVwYXRoOiBkZXN0RmlsZS5wYXRoLFxuXHRcdFx0c2VjdGlvbjogc3VicGF0aFxuXHRcdH07XG5cdH1cblxuXHRwcml2YXRlIHBhcnNlTGlua3RleHQobGlua3RleHQ6IHN0cmluZyk6IHsgcGF0aDogc3RyaW5nOyBzdWJwYXRoPzogc3RyaW5nIH0gfCB1bmRlZmluZWQge1xuXHRcdC8vIEljaSwgdHUgZG9pcyBcdTAwRTljcmlyZSBkdSBjb2RlIHBvdXIgYW5hbHlzZXIgbGUgbGllbiBldCBleHRyYWlyZSBsZSBjaGVtaW4gZXQgbGUgc291cy1jaGVtaW5cblx0XHQvLyBDZXR0ZSBmb25jdGlvbiBlc3QgdW4gZXhlbXBsZSBkZSBzdHJ1Y3R1cmUgZXQgZG9pdCBcdTAwRUF0cmUgYWRhcHRcdTAwRTllIFx1MDBFMCB0b24gYmVzb2luXG5cdFx0Y29uc3QgbWF0Y2ggPSBsaW5rdGV4dC5tYXRjaCgvXFxbXFxbKFteXFxdXSs/KSgjKFteI10rPykpP1xcXVxcXS8pO1xuXG5cdFx0aWYgKG1hdGNoKSB7XG5cdFx0XHRjb25zdCBsaW5rQW5kTGFiZWwgPSBtYXRjaFsxXS5zcGxpdCgnfCcpO1xuXHRcdFx0cmV0dXJuIHsgcGF0aDogbGlua0FuZExhYmVsWzBdLCBzdWJwYXRoOiBtYXRjaFszXSB9O1xuXHRcdH1cblx0XHRyZXR1cm4gdW5kZWZpbmVkOyAvLyBDYXMgcGFyIGRcdTAwRTlmYXV0IHNpIGxlIGxpZW4gbidlc3QgcGFzIGF1IGZvcm1hdCBhdHRlbmR1XG5cdH1cblxuXHRwcml2YXRlIGV4dHJhY3RTZWN0aW9uQ29udGVudChjb250ZW50OiBzdHJpbmcsIHN1YnBhdGg6IHN0cmluZyk6IHN0cmluZyB7XG5cdFx0Y29uc3QgbGluZXMgPSBjb250ZW50LnNwbGl0KCdcXG4nKTtcblx0XHRsZXQgc2VjdGlvbkNvbnRlbnQgPSAnJztcblx0XHRsZXQgaW5TZWN0aW9uID0gZmFsc2U7XG5cdFx0bGV0IGN1cnJlbnRMZXZlbCA9IDA7XG5cblx0XHRmb3IgKGNvbnN0IGxpbmUgb2YgbGluZXMpIHtcblx0XHRcdGNvbnN0IGhlYWRlck1hdGNoID0gbGluZS5tYXRjaCgvXigjKylcXHMrKC4qKS8pO1xuXHRcdFx0aWYgKGhlYWRlck1hdGNoKSB7XG5cdFx0XHRcdGNvbnN0IGxldmVsID0gaGVhZGVyTWF0Y2hbMV0ubGVuZ3RoO1xuXHRcdFx0XHRjb25zdCB0aXRsZSA9IGhlYWRlck1hdGNoWzJdLnRyaW0oKTtcblxuXHRcdFx0XHRpZiAoaW5TZWN0aW9uICYmIGxldmVsIDw9IGN1cnJlbnRMZXZlbCkge1xuXHRcdFx0XHRcdC8vIFNpIG9uIGVzdCBkXHUwMEU5alx1MDBFMCBkYW5zIGxhIHNlY3Rpb24gZXQgcXUnb24gcmVuY29udHJlIHVuIGhlYWRlciBkZSBuaXZlYXUgXHUwMEU5Z2FsIG91IHN1cFx1MDBFOXJpZXVyLFxuXHRcdFx0XHRcdC8vIGNlbGEgc2lnbmlmaWUgcXUnb24gYSBhdHRlaW50IGxhIGZpbiBkZSBsYSBzZWN0aW9uIGQnaW50XHUwMEU5clx1MDBFQXQuXG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRpZiAodGl0bGUgPT09IHN1YnBhdGgpIHtcblx0XHRcdFx0XHQvLyBTaSBsZSB0aXRyZSBjb3JyZXNwb25kIGF1IHN1YnBhdGggcmVjaGVyY2hcdTAwRTksXG5cdFx0XHRcdFx0Ly8gb24gY29tbWVuY2UgXHUwMEUwIGNhcHR1cmVyIGxlIGNvbnRlbnUgXHUwMEUwIHBhcnRpciBkZSBjZSBwb2ludC5cblx0XHRcdFx0XHRpblNlY3Rpb24gPSB0cnVlO1xuXHRcdFx0XHRcdGN1cnJlbnRMZXZlbCA9IGxldmVsO1xuXHRcdFx0XHRcdGNvbnRpbnVlOyAvLyBQYXNzZSBcdTAwRTAgbCdpdFx1MDBFOXJhdGlvbiBzdWl2YW50ZSBzYW5zIGFqb3V0ZXIgbGUgdGl0cmUgbHVpLW1cdTAwRUFtZSBhdSBjb250ZW51LlxuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHRcdGlmIChpblNlY3Rpb24pIHtcblx0XHRcdFx0Ly8gQWpvdXRlIGxhIGxpZ25lIGNvdXJhbnRlIGF1IGNvbnRlbnUgZGUgbGEgc2VjdGlvbiBzaSBvbiBlc3QgZGFucyBsYSBzZWN0aW9uIGQnaW50XHUwMEU5clx1MDBFQXQuXG5cdFx0XHRcdHNlY3Rpb25Db250ZW50ICs9IGxpbmUgKyAnXFxuJztcblx0XHRcdH1cblx0XHR9XG5cblx0XHRyZXR1cm4gc2VjdGlvbkNvbnRlbnQudHJpbSgpO1xuXHR9XG59XG4iLCAiaW1wb3J0IHsgUExBQ0VIT0xERVJfUkVHRVggfSBmcm9tIFwiLi9wcm9tcHRcIjtcblxudHlwZSBQbGFjZWhvbGRlckxldmVscyA9IHsgW3BsYWNlaG9sZGVyOiBzdHJpbmddOiBudW1iZXIgfTtcblxuZXhwb3J0IGZ1bmN0aW9uIHJlbGV2ZWxNYXJrZG93bkhlYWRlcnMobWFya2Rvd246IHN0cmluZywgdGFyZ2V0QmFzZUxldmVsOiBudW1iZXIpOiBzdHJpbmcge1xuXHRjb25zdCBsaW5lcyA9IG1hcmtkb3duLnNwbGl0KCdcXG4nKTtcblx0bGV0IGFkanVzdGVkTWFya2Rvd24gPSAnJztcblxuXHQvLyBUcm91dmVyIGxlIG5pdmVhdSBtaW5pbXVtIGFjdHVlbCBkZXMgaGVhZGVycyBkYW5zIGxlIG1hcmtkb3duXG5cdGxldCBtaW5DdXJyZW50TGV2ZWwgPSBJbmZpbml0eTtcblx0bGluZXMuZm9yRWFjaChsaW5lID0+IHtcblx0XHRjb25zdCBtYXRjaCA9IGxpbmUubWF0Y2goL14oIyspLyk7XG5cdFx0aWYgKG1hdGNoKSB7XG5cdFx0XHRjb25zdCBsZXZlbCA9IG1hdGNoWzBdLmxlbmd0aDtcblx0XHRcdGlmIChsZXZlbCA8IG1pbkN1cnJlbnRMZXZlbCkge1xuXHRcdFx0XHRtaW5DdXJyZW50TGV2ZWwgPSBsZXZlbDtcblx0XHRcdH1cblx0XHR9XG5cdH0pO1xuXG5cdC8vIENhbGN1bGVyIGxlIGRcdTAwRTljYWxhZ2Ugblx1MDBFOWNlc3NhaXJlIHBvdXIgYWp1c3RlciBsZSBuaXZlYXUgZGVzIGhlYWRlcnNcblx0Y29uc3QgbGV2ZWxPZmZzZXQgPSB0YXJnZXRCYXNlTGV2ZWwgLSBtaW5DdXJyZW50TGV2ZWw7XG5cblx0bGluZXMuZm9yRWFjaChsaW5lID0+IHtcblx0XHRjb25zdCBtYXRjaCA9IGxpbmUubWF0Y2goL14oIyspKFxccysuKikvKTtcblx0XHRpZiAobWF0Y2gpIHtcblx0XHRcdGxldCBuZXdMZXZlbCA9IG1hdGNoWzFdLmxlbmd0aCArIGxldmVsT2Zmc2V0O1xuXHRcdFx0aWYgKG5ld0xldmVsIDwgMSkgbmV3TGV2ZWwgPSAxOyAvLyBBc3N1cmUgcXVlIGxlIG5pdmVhdSBlc3QgYXUgbW9pbnMgMVxuXHRcdFx0aWYgKG5ld0xldmVsID4gNikge1xuXHRcdFx0XHQvLyBTaSBsZSBuaXZlYXUgZFx1MDBFOXBhc3NlIDYsIGNvbnZlcnRpciBlbiB0ZXh0ZSBlbiBncmFzIGF2ZWMgbnVtXHUwMEU5cm90YXRpb25cblx0XHRcdFx0Y29uc3QgYm9sZFRleHQgPSBgKioke25ld0xldmVsIC0gNn0uICR7bWF0Y2hbMl0udHJpbSgpfSoqYDtcblx0XHRcdFx0YWRqdXN0ZWRNYXJrZG93biArPSBib2xkVGV4dCArICdcXG4nO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0Y29uc3QgbmV3SGVhZGVyID0gYCR7JyMnLnJlcGVhdChuZXdMZXZlbCl9JHttYXRjaFsyXX1gO1xuXHRcdFx0XHRhZGp1c3RlZE1hcmtkb3duICs9IG5ld0hlYWRlciArICdcXG4nO1xuXHRcdFx0fVxuXHRcdH0gZWxzZSB7XG5cdFx0XHRhZGp1c3RlZE1hcmtkb3duICs9IGxpbmUgKyAnXFxuJztcblx0XHR9XG5cdH0pO1xuXG5cdHJldHVybiBhZGp1c3RlZE1hcmtkb3duLnRyaW0oKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNvbXB1dGVQbGFjZUhvbGRlcnNNYXJrZG93bkxldmVsKG1hcmtkb3duOiBzdHJpbmcpOiBQbGFjZWhvbGRlckxldmVscyB7XG5cdGNvbnN0IGxpbmVzID0gbWFya2Rvd24uc3BsaXQoJ1xcbicpO1xuXHRsZXQgY3VycmVudExldmVsID0gMDtcblx0bGV0IHJlc3VsdDogUGxhY2Vob2xkZXJMZXZlbHMgPSB7fTtcblxuXHRsaW5lcy5mb3JFYWNoKGxpbmUgPT4ge1xuXHRcdC8vIERcdTAwRTl0ZWN0ZXIgbGVzIG5pdmVhdXggZGUgaGVhZGVyXG5cdFx0Y29uc3QgaGVhZGVyTWF0Y2ggPSBsaW5lLm1hdGNoKC9eKCMrKS8pO1xuXHRcdGlmIChoZWFkZXJNYXRjaCkge1xuXHRcdFx0Y3VycmVudExldmVsID0gaGVhZGVyTWF0Y2hbMF0ubGVuZ3RoO1xuXHRcdH1cblxuXHRcdC8vIERcdTAwRTl0ZWN0ZXIgbGVzIHBsYWNlaG9sZGVyc1xuXHRcdGNvbnN0IHBsYWNlaG9sZGVyTWF0Y2hlcyA9IFsuLi5saW5lLm1hdGNoQWxsKG5ldyBSZWdFeHAoUExBQ0VIT0xERVJfUkVHRVgsICdnJykpXTtcblx0XHRwbGFjZWhvbGRlck1hdGNoZXMuZm9yRWFjaChtYXRjaCA9PiB7XG5cdFx0XHRjb25zdCBwbGFjZWhvbGRlck5hbWUgPSBtYXRjaFsxXTtcblx0XHRcdGlmIChwbGFjZWhvbGRlck5hbWUgJiYgIShwbGFjZWhvbGRlck5hbWUgaW4gcmVzdWx0KSkge1xuXHRcdFx0XHQvLyBBc3NpZ25lciBsZSBuaXZlYXUgYWN0dWVsIGF1IHBsYWNlaG9sZGVyIHMnaWwgbidhIHBhcyBlbmNvcmUgXHUwMEU5dFx1MDBFOSB0cm91dlx1MDBFOVxuXHRcdFx0XHRyZXN1bHRbcGxhY2Vob2xkZXJOYW1lXSA9IGN1cnJlbnRMZXZlbDtcblx0XHRcdH1cblx0XHR9KTtcblxuXHRcdC8vIFJcdTAwRTlpbml0aWFsaXNlciBsZSBuaXZlYXUgcG91ciBsZXMgbGlnbmVzIHNhbnMgaGVhZGVyXG5cdFx0aWYgKCFoZWFkZXJNYXRjaCAmJiAhbGluZS50cmltKCkuc3RhcnRzV2l0aCgne3snKSkge1xuXHRcdFx0Y3VycmVudExldmVsID0gMDtcblx0XHR9XG5cdH0pO1xuXG5cdHJldHVybiByZXN1bHQ7XG59XG4iLCAiaW1wb3J0IHsgY29tcHV0ZVBsYWNlSG9sZGVyc01hcmtkb3duTGV2ZWwsIHJlbGV2ZWxNYXJrZG93bkhlYWRlcnMgfSBmcm9tIFwiLi9tYXJrZG93bi1sZXZlbGVyXCI7XG5cbmV4cG9ydCBjb25zdCBQTEFDRUhPTERFUl9SRUdFWCA9ICdcXFxce1xcXFx7KFtcXFxcdy1dKylcXFxcfVxcXFx9JztcblxuZXhwb3J0IGNsYXNzIFByb21wdCB7XG5cdGNvbnN0cnVjdG9yKFxuXHRcdHB1YmxpYyByZWFkb25seSB0ZW1wbGF0ZTogc3RyaW5nLFxuXHRcdHByaXZhdGUgcmVhZG9ubHkgZmlsZXBhdGg6IHN0cmluZyxcblx0XHRwcml2YXRlIHJlYWRvbmx5IHNlY3Rpb246IHN0cmluZyB8IHVuZGVmaW5lZCA9IHVuZGVmaW5lZFxuXHQpIHt9XG5cblx0cHVibGljIHJlbXBsYWNlUGxhY2Vob2xkZXJzKHZhcmlhYmxlczoge1trZXk6IHN0cmluZ106IHN0cmluZ30pOiBzdHJpbmcge1xuXHRcdGNvbnN0IHBsYWNlaG9sZGVyc0xldmVscyA9IGNvbXB1dGVQbGFjZUhvbGRlcnNNYXJrZG93bkxldmVsKHRoaXMudGVtcGxhdGUpO1xuXHRcdHJldHVybiB0aGlzLnRlbXBsYXRlLnJlcGxhY2UobmV3IFJlZ0V4cChQTEFDRUhPTERFUl9SRUdFWCwgJ2cnKSwgKG1hdGNoLCB2YXJpYWJsZU5hbWUpID0+IHtcblx0XHRcdGlmICghdmFyaWFibGVzLmhhc093blByb3BlcnR5KHZhcmlhYmxlTmFtZSkpIHtcblx0XHRcdFx0dGhyb3cgbmV3IEVycm9yKGBWYXJpYWJsZSAnJHt2YXJpYWJsZU5hbWV9JyBub3QgZm91bmRgKTtcblx0XHRcdH1cblx0XHRcdGNvbnN0IHBsYWNlaG9sZGVyTGV2ZWwgPSBwbGFjZWhvbGRlcnNMZXZlbHNbdmFyaWFibGVOYW1lXTtcblx0XHRcdGNvbnN0IG1hcmtkb3duID0gdmFyaWFibGVzW3ZhcmlhYmxlTmFtZV07XG5cdFx0XHRyZXR1cm4gcmVsZXZlbE1hcmtkb3duSGVhZGVycyhtYXJrZG93biwgcGxhY2Vob2xkZXJMZXZlbCArIDEpO1xuXHRcdH0pO1xuXHR9XG5cblx0cHVibGljIGlzRXF1YWwob3RoZXI6IFByb21wdCk6IGJvb2xlYW4ge1xuXHRcdHJldHVybiB0aGlzLmZpbGVwYXRoID09PSBvdGhlci5maWxlcGF0aCAmJiB0aGlzLnNlY3Rpb24gPT09IG90aGVyLnNlY3Rpb247XG5cdH1cblxuXHRwdWJsaWMgZ2V0UHJvbXB0SWQoKTogc3RyaW5nIHtcblx0XHRyZXR1cm4gISF0aGlzLnNlY3Rpb24gPyBgJHt0aGlzLmZpbGVwYXRofSMke3RoaXMuc2VjdGlvbn1gIDogdGhpcy5maWxlcGF0aDtcblx0fVxuXG59XG4iLCAiZXhwb3J0IGZ1bmN0aW9uIGdldFZhcmlhYmxlcyhjb250ZW50OiBzdHJpbmcpOiBTZXQ8c3RyaW5nPiB7XG5cdGNvbnN0IHJlZ2V4ID0gL3t7KFtcXHctXSspfX0vZzsgLy8gTW9kaWZpXHUwMEU5IHBvdXIgaW5jbHVyZSBkZXMgdGlyZXRzIGRhbnMgbGVzIG5vbXMgZGUgdmFyaWFibGVzXG5cdGxldCBtYXRjaDtcblx0Y29uc3QgdmFyaWFibGVzID0gbmV3IFNldDxzdHJpbmc+KCk7XG5cblx0d2hpbGUgKChtYXRjaCA9IHJlZ2V4LmV4ZWMoY29udGVudCkpICE9PSBudWxsKSB7XG5cdFx0dmFyaWFibGVzLmFkZChtYXRjaFsxXSk7XG5cdH1cblx0cmV0dXJuIHZhcmlhYmxlcztcbn1cblxuXG5pbnRlcmZhY2UgQ29kZUJsb2Mge1xuXHRjb250ZW50OiBzdHJpbmc7XG5cdGJsb2NUeXBlOiBzdHJpbmcgfCB1bmRlZmluZWQ7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRDb2RlQmxvYyhjb250ZW50OiBzdHJpbmcpOiBDb2RlQmxvYyB8IHVuZGVmaW5lZCB7XG5cdGNvbnN0IHJlZ2V4ID0gL15cXHMqYGBgKFxcdyopXFxuKFtcXHNcXFNdKj8pXFxuYGBgXFxzKiQvO1xuXHRjb25zdCBjb3JyZXNwb25kYW5jZSA9IGNvbnRlbnQubWF0Y2gocmVnZXgpO1xuXHRpZiAoY29ycmVzcG9uZGFuY2UpIHtcblx0XHRyZXR1cm4ge1xuXHRcdFx0Y29udGVudDogY29ycmVzcG9uZGFuY2VbMl0udHJpbSgpLFxuXHRcdFx0YmxvY1R5cGU6IGNvcnJlc3BvbmRhbmNlWzFdID09PSAnJyA/IHVuZGVmaW5lZCA6IGNvcnJlc3BvbmRhbmNlWzFdXG5cdFx0fTtcblx0fVxuXHRyZXR1cm4gdW5kZWZpbmVkOyAvLyBSZXRvdXJuZSB1bmRlZmluZWQgc2kgYXVjdW4gYmxvYyBkZSBjb2RlIG4nZXN0IHRyb3V2XHUwMEU5XG59XG5cbmV4cG9ydCBmdW5jdGlvbiByZW1vdmVGcm9udG1hdHRlcihjb250ZW50OiBzdHJpbmcpIHtcblx0Ly8gQ2V0dGUgZXhwcmVzc2lvbiByXHUwMEU5Z3VsaVx1MDBFOHJlIGNoZXJjaGUgbGVzIHBhcnRpZXMgZW5jYWRyXHUwMEU5ZXMgcGFyIFwiLS0tXCIgYXUgZFx1MDBFOWJ1dCBkdSB0ZXh0ZVxuXHRjb25zdCByZWdleCA9IC9eLS0tW1xcc1xcU10rPy0tLVxcbj8vO1xuXHQvLyBSZW1wbGFjZSBsZSBmcm9udG1hdHRlciBwYXIgdW5lIGNoYVx1MDBFRW5lIHZpZGUgcydpbCBlc3QgdHJvdXZcdTAwRTlcblx0cmV0dXJuIGNvbnRlbnQucmVwbGFjZShyZWdleCwgJycpO1xufVxuXG4iLCAiaW1wb3J0IHsgQXBwLCBNb2RhbCwgU2V0dGluZyB9IGZyb20gXCJvYnNpZGlhblwiO1xuXG5leHBvcnQgY2xhc3MgQ29weVByb21wdE1vZGFsIGV4dGVuZHMgTW9kYWwge1xuXHRwcm9tcHQ6IHN0cmluZztcblx0b25TdWJtaXQ6IChyZXN1bHQ6IHN0cmluZykgPT4gdm9pZDtcblxuXHRjb25zdHJ1Y3RvcihhcHA6IEFwcCwgcHJvbXB0OiBzdHJpbmcsIG9uU3VibWl0OiAocmVzdWx0OiBzdHJpbmcpID0+IHZvaWQpIHtcblx0XHRzdXBlcihhcHApO1xuXHRcdHRoaXMub25TdWJtaXQgPSBvblN1Ym1pdDtcblx0XHR0aGlzLnByb21wdCA9IHByb21wdDtcblx0fVxuXG5cdG9uT3BlbigpIHtcblx0XHRjb25zdCB7IGNvbnRlbnRFbCB9ID0gdGhpcztcblxuXHRcdGNvbnRlbnRFbC5jcmVhdGVFbChcImgxXCIsIHsgdGV4dDogXCJQcm9tcHRcIiB9KTtcblxuXHRcdGNvbnN0IHRleHRhcmVhID0gY29udGVudEVsLmNyZWF0ZUVsKFwidGV4dGFyZWFcIiwge1xuXHRcdFx0YXR0cjoge1xuXHRcdFx0XHRzdHlsZTogXCJ3aWR0aDogMTAwJTsgYm94LXNpemluZzogYm9yZGVyLWJveDsgbWFyZ2luLWJvdHRvbTogMjBweDtcIiAvLyBBc3N1cmUgcXVlIGxlIHRleHRhcmVhIHByZW5kIHRvdXRlIGxhIGxhcmdldXIgZXQgYWpvdXRlIHVuIHBldSBkJ2VzcGFjZSBlbiBkZXNzb3VzXG5cdFx0XHR9XG5cdFx0fSk7XG5cdFx0dGV4dGFyZWEudmFsdWUgPSB0aGlzLnByb21wdDtcblx0XHR0ZXh0YXJlYS5yb3dzID0gMTA7XG5cblx0XHRjb25zdCBidXR0b25Db250YWluZXIgPSBjb250ZW50RWwuY3JlYXRlRWwoXCJkaXZcIiwge1xuXHRcdFx0YXR0cjoge1xuXHRcdFx0XHRzdHlsZTogXCJ0ZXh0LWFsaWduOiByaWdodDtcIiAvLyBBbGlnbmVtZW50IGR1IGJvdXRvbiBcdTAwRTAgZHJvaXRlXG5cdFx0XHR9XG5cdFx0fSk7XG5cblx0XHRjb25zdCBidXR0b24gPSBidXR0b25Db250YWluZXIuY3JlYXRlRWwoXCJidXR0b25cIiwgeyB0ZXh0OiBcIkNvcHlcIiB9KTtcblx0XHRidXR0b24uYWRkQ2xhc3MoXCJtb2QtY3RhXCIpO1xuXHRcdGJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuXHRcdFx0dGhpcy5jbG9zZSgpO1xuXHRcdFx0dGhpcy5vblN1Ym1pdCh0ZXh0YXJlYS52YWx1ZSk7XG5cdFx0fSk7XG5cdH1cblxuXHRvbkNsb3NlKCkge1xuXHRcdGxldCB7IGNvbnRlbnRFbCB9ID0gdGhpcztcblx0XHRjb250ZW50RWwuZW1wdHkoKTtcblx0fVxufVxuIiwgImltcG9ydCB7IE1vZGFsLCBBcHAsIE5vdGljZSB9IGZyb20gJ29ic2lkaWFuJztcblxuZXhwb3J0IGNsYXNzIEVycm9yTW9kYWwgZXh0ZW5kcyBNb2RhbCB7XG5cdG1lc3NhZ2U6IHN0cmluZztcblxuXHRjb25zdHJ1Y3RvcihhcHA6IEFwcCwgbWVzc2FnZTogc3RyaW5nKSB7XG5cdFx0c3VwZXIoYXBwKTtcblx0XHR0aGlzLm1lc3NhZ2UgPSBtZXNzYWdlO1xuXHR9XG5cblx0b25PcGVuKCkge1xuXHRcdGNvbnN0IHsgY29udGVudEVsIH0gPSB0aGlzO1xuXG5cdFx0Ly8gQ3JcdTAwRTllciB1biBcdTAwRTlsXHUwMEU5bWVudCBkZSBwYXJhZ3JhcGhlIHBvdXIgbGUgbWVzc2FnZVxuXHRcdGNvbnN0IG1lc3NhZ2VFbCA9IGNvbnRlbnRFbC5jcmVhdGVFbCgncCcpO1xuXHRcdG1lc3NhZ2VFbC5zZXRUZXh0KHRoaXMubWVzc2FnZSk7XG5cblx0XHQvLyBDclx1MDBFOWVyIHVuIGJvdXRvbiBlbiBkZXNzb3VzIGR1IG1lc3NhZ2Vcblx0XHRjb25zdCBva0J1dHRvbiA9IGNvbnRlbnRFbC5jcmVhdGVFbCgnYnV0dG9uJywge1xuXHRcdFx0dGV4dDogJ09LJyxcblx0XHRcdGNsczogJ21vZC1jdGEnICAvLyBVdGlsaXNlIHVuZSBjbGFzc2UgcG91ciBham91dGVyIGRlcyBzdHlsZXMgc3BcdTAwRTljaWZpcXVlcyBzaSBuXHUwMEU5Y2Vzc2FpcmVcblx0XHR9KTtcblx0XHRva0J1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcblx0XHRcdHRoaXMuY2xvc2UoKTtcblx0XHR9KTtcblxuXHRcdC8vIFN0eWxlIG9wdGlvbm5lbCBwb3VyIGFtXHUwMEU5bGlvcmVyIGwnYXBwYXJlbmNlXG5cdFx0Y29udGVudEVsLnN0eWxlLmRpc3BsYXkgPSAnZmxleCc7XG5cdFx0Y29udGVudEVsLnN0eWxlLmZsZXhEaXJlY3Rpb24gPSAnY29sdW1uJztcblx0XHRjb250ZW50RWwuc3R5bGUuYWxpZ25JdGVtcyA9ICdjZW50ZXInO1xuXHRcdGNvbnRlbnRFbC5zdHlsZS5qdXN0aWZ5Q29udGVudCA9ICdjZW50ZXInO1xuXHR9XG5cblx0b25DbG9zZSgpIHtcblx0XHRjb25zdCB7Y29udGVudEVsfSA9IHRoaXM7XG5cdFx0Y29udGVudEVsLmVtcHR5KCk7XG5cdH1cbn1cblxuLy8gVXRpbGlzYXRpb246XG5mdW5jdGlvbiBzaG93RXJyb3IoYXBwOiBBcHAsIG1lc3NhZ2U6IHN0cmluZykge1xuXHRuZXcgRXJyb3JNb2RhbChhcHAsIG1lc3NhZ2UpLm9wZW4oKTtcbn1cblxuLy8gQXBwZWxlciBzaG93RXJyb3IgcXVlbHF1ZSBwYXJ0IGRhbnMgdG9uIGNvZGUgYXZlYyBsJ2luc3RhbmNlIGQnQXBwIGV0IGxlIG1lc3NhZ2UgZCdlcnJldXIgOlxuLy8gc2hvd0Vycm9yKGFwcCwgJ1VuZSBlcnJldXIgZXN0IHN1cnZlbnVlLCB2ZXVpbGxleiByXHUwMEU5ZXNzYXllci4nKTtcbiJdLAogICJtYXBwaW5ncyI6ICI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxJQUFBQSxtQkFBdUI7OztBQ0F2QixJQUFBQyxtQkFBcUQ7OztBQ0FyRCxzQkFBMkI7OztBQ0lwQixTQUFTLHVCQUF1QixVQUFrQixpQkFBaUM7QUFDekYsUUFBTSxRQUFRLFNBQVMsTUFBTSxJQUFJO0FBQ2pDLE1BQUksbUJBQW1CO0FBR3ZCLE1BQUksa0JBQWtCO0FBQ3RCLFFBQU0sUUFBUSxVQUFRO0FBQ3JCLFVBQU0sUUFBUSxLQUFLLE1BQU0sT0FBTztBQUNoQyxRQUFJLE9BQU87QUFDVixZQUFNLFFBQVEsTUFBTSxDQUFDLEVBQUU7QUFDdkIsVUFBSSxRQUFRLGlCQUFpQjtBQUM1QiwwQkFBa0I7QUFBQSxNQUNuQjtBQUFBLElBQ0Q7QUFBQSxFQUNELENBQUM7QUFHRCxRQUFNLGNBQWMsa0JBQWtCO0FBRXRDLFFBQU0sUUFBUSxVQUFRO0FBQ3JCLFVBQU0sUUFBUSxLQUFLLE1BQU0sY0FBYztBQUN2QyxRQUFJLE9BQU87QUFDVixVQUFJLFdBQVcsTUFBTSxDQUFDLEVBQUUsU0FBUztBQUNqQyxVQUFJLFdBQVc7QUFB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
